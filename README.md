# SCOPE

This repository contains the PyTorch implementation of our manuscript "Self-Supervised Coordinate Projection Network for Sparse-View Computed Tomography". [[ArXiv](https://arxiv.org/abs/2209.05483)]

## 1.  Main Running Environment

To run this project, you will need the following packages:
- PyTorch
- tinycudann
- SimpleITK, tqdm, numpy, and other packages.

## 2. File Tree

```text
SCOPE
│ config.json   # configuration file for hash encoding
│ dataset.py
│ README.md
│ train.py      # trains the SCOPE model and generates dense-view sinograms
│ utils.py
│
├─data
│ 90_img_0_80.nii   # CT image generated by FBP on the SV sinogram (90_sino_0_80.nii)
│ 90_sino_0_80.nii  # SV sinogram (input data)
│ gt_img_0_80.nii   # CT image generated by FBP on the GT DV sinogram (gt_sino_0_80.nii). This is GT image.
│ gt_sino_0_80.nii  # GT DV sinogram
│
├─model
│ model_param_covid19_80_90.pkl    # pre-trained model for SV sinogram (90_sino_0_80.nii)
│
├─output
│ ├─img
│ │ scope_sin_pre_80_90.nii    # CT image obtained by FBP on the generated DV sinogram (our final result).
│ │
│ └─sino
│ sin_pre_80_90.nii    # DV sinogram generated by SCOPE.
│
├─script_matlab
│ gene_angle.m
│ gene_img.m    # FBP algorithm used to recover the CT image
```


## 3. Training from Scratch

To train the model from scratch, navigate to `./` and run the following command in your terminal:
```shell
python train.py
```
This will train the model for the input sinogram (`sin_pre_80_90.nii`). The pre-trained model and the generated DN sinogram will be stored in `./model` and `./output/sino`, respectively. 

Next, navigate to `./script_matlab` and use MATLAB to run gene_img.m to recover the final CT image, which will be stored in `./output/img`.

## 4. Evaluation

To qualitatively evalute the result, navigate to `./` and run the following comman in your terminal:
```shell
python eval.py
```
This will compute PSNR and SSIM values for the reconstruced image (`./output/img/scope_sin_pre_80_90.nii`). PSNR and SSIM are respectively 41.03 dB and 0.9829 for our provided result.

## 5. Citation

If you find our work useful in your research, please cite:

```
@misc{wu2022selfsupervised,
      title={Self-Supervised Coordinate Projection Network for Sparse-View Computed Tomography}, 
      author={Qing Wu and Ruimin Feng and Hongjiang Wei and Jingyi Yu and Yuyao Zhang},
      year={2022},
      eprint={2209.05483},
      archivePrefix={arXiv},
      primaryClass={eess.IV}
}
```
